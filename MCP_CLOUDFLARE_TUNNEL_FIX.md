# ğŸ”§ Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© 403 ÙÙŠ Cloudflare Tunnel - MCP Endpoint

## Ø§Ù„Ù…Ø´ÙƒÙ„Ø©
```
403 ERROR
The request could not be satisfied.
This distribution is not configured to allow the HTTP request method that was used for this request. The distribution supports only cachable requests.
Generated by cloudfront (CloudFront)
```

## âœ… Ø§Ù„Ø­Ù„ÙˆÙ„

### 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Cloudflare Tunnel Configuration

Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù‚Ø¯ ØªÙƒÙˆÙ† ÙÙŠ Cloudflare Tunnel configuration. ØªØ­Ù‚Ù‚ Ù…Ù†:

#### Ø£. Tunnel Routing
ÙÙŠ Cloudflare Dashboard â†’ Zero Trust â†’ Networks â†’ Tunnels:

1. Ø§Ø®ØªØ± Tunnel Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
2. ØªØ­Ù‚Ù‚ Ù…Ù† **Public Hostnames**
3. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† `/api/mcp` ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ù‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­

#### Ø¨. Tunnel Config File
ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„Ù config Ø§Ù„Ø®Ø§Øµ Ø¨Ù€ Tunnel:

```yaml
tunnel: your-tunnel-id
credentials-file: /path/to/credentials.json

ingress:
  - hostname: api.zien-ai.app
    service: http://localhost:5000
    originRequest:
      httpHostHeader: api.zien-ai.app
      noHappyEyeballs: false
      keepAliveConnections: 10
      keepAliveTimeout: 90s
      tcpKeepAlive: 30s
      disableChunkedEncoding: false
```

### 2. Ø¥Ø¶Ø§ÙØ© Origin Request Settings

ÙÙŠ Cloudflare Tunnel configØŒ Ø£Ø¶Ù:

```yaml
ingress:
  - hostname: api.zien-ai.app
    service: http://localhost:5000
    originRequest:
      httpHostHeader: api.zien-ai.app
      noHappyEyeballs: false
      keepAliveConnections: 10
      keepAliveTimeout: 90s
      tcpKeepAlive: 30s
      disableChunkedEncoding: false
      # âœ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
      connectTimeout: 30s
      tlsTimeout: 10s
      tcpKeepAlive: 30s
      noHappyEyeballs: false
```

### 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Cloudflare Tunnel Status

```bash
pm2 logs CF-MAESTRO --lines 20
```

ØªØ­Ù‚Ù‚ Ù…Ù†:
- Tunnel Ù…ØªØµÙ„
- Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ routing
- Public hostnames ØµØ­ÙŠØ­Ø©

### 4. Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Cloudflare Tunnel

```bash
pm2 restart CF-MAESTRO
```

### 5. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Backend

ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Backend ÙŠØ¹Ù…Ù„:

```bash
curl http://localhost:5000/api/mcp
```

Ø¥Ø°Ø§ Ø¹Ù…Ù„ Ù…Ø­Ù„ÙŠØ§Ù‹ØŒ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Tunnel configuration.

---

## ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Cloudflare Dashboard

### 1. Zero Trust â†’ Networks â†’ Tunnels

1. Ø§Ø®ØªØ± Tunnel Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
2. ØªØ­Ù‚Ù‚ Ù…Ù† **Public Hostnames**
3. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† `api.zien-ai.app` â†’ `http://localhost:5000`

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Routing

ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†:
- Hostname: `api.zien-ai.app`
- Service: `http://localhost:5000`
- Path: (ÙØ§Ø±Øº Ø£Ùˆ `/api/*`)

---

## âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

1. **Cloudflare Tunnel** ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ØªØµÙ„
2. **Backend** ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ `localhost:5000`
3. **Routing** ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ØµØ­ÙŠØ­
4. **Origin Request Settings** Ù…Ù‡Ù…Ø© Ù„Ù„Ù€ SSE

---

## âœ… Checklist

- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Tunnel Status
- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Tunnel Config
- [ ] Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Public Hostnames
- [ ] Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Tunnel
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† localhost
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Cloudflare

---

**ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:** 2025-01-XX  
**Ø§Ù„Ø­Ø§Ù„Ø©:** ğŸ”§ Ù‚ÙŠØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­

